<html>
<head>
<title>Rules</title>
<link rel="stylesheet" href="poptray.css">
</head>

<body>

<script language="JavaScript" src="header.js"></script>

<table align="center" border="0" cellspacing="0" cellpadding="0">
	<tr>
		<th>Rules</th>
	</tr>
	<tr>
		<td class="info"> Rules allow you to perform various automated tasks as new e-mails
			arrive depending on the contents of each message.<br><br>
			A Help button <img src="img/help.png" height=23 width=63> can be found in the 
			lower left corner of the screen.<br>
			<br>
			At the top there are the three main buttons used for rule management:<br><br>
			<table border="0" width="90%" align="center" cellspacing="4" cellpadding="2">
				<tr>
					<td width="100" class="light" align="center"><img src="img/addrule.gif" width="77" height="22"></td>
					<td class="light">Add a new rule. First click this button
						and then fill in the details that will show up just to the right of the rule list.</td>
				</tr>
				<tr>
					<td class="light" align="center"><img src="img/delrule.gif" width="88" height="22"></td>
					<td class="light">Delete the currently selected rule.</td>
				</tr>
				<tr>
					<td class="light" align="center"><img src="img/importrules.gif" width="96" height="22"></td>
					<td class="light">Import the rules from someone elses RULES.INI file.</td>
				</tr>
			</table>
			<br>
			Just below the main buttons and to the left, is the list of all the rules
			you may have defined or just added. You may enable or disable each rule
			by clicking the checkmark next to the rule in the list or from the rule 
			details area. Selecting a rule will list its details with all of its
			various options, criteria and actions you want for the rule.<br><br>
			Just to the right of the rules list is where you will be adding or editing
			the rule details. The following can be set:<br><br>
			<table border="0" width="90%" align="center" cellspacing="4" cellpadding="2">
				<tr>
					<td class="light" align="center">Name</td>
					<td class="light">Name is for your own identification of the rule, 
						you may choose whatever you like. <b>TIP:</b> A descriptive name may make it
						easier for organizing your rules.</td>
				</tr>
				<tr>
					<td class="light" align="center">Enabled</td>
					<td class="light">Checkbox to Enable or Disable the rule. Only
						enabled rules will be run.</td>
				</tr>
				<tr>
					<td class="light" align="center">Account<a name="aname"></a></td>
					<td class="light">This can make the rule work either with
						all of the accounts or just one specified account.</td>
				</tr>
				<tr>
					<td class="light" align="center">New Messages Only</td>
					<td class="light">If enabled, the rule will only test an e-mail message if it
						arrived since the last mail check, all previous messages will not be tested again.</td>
				</tr>
				<tr>
					<td class="light" align="center">Needed</td>
					<td class="light">Selects if the rule is to work
						if <u>ANY</u> of the criteria rows match <i>(ANY Row)</i> or only when
						<u>ALL</u> of the criteria rows match <i>(ALL Rows)</i>.<br><br>
						<b>Tip:</b> Use <i>(ANY Row)</i> to group similar criteria that will use the same
						actions you want performed such as those that may identify spam.<br>
						Use <i>(ALL Row)</i> to create more complex rules that require several criteria 
						to match and then select the actions you want performed.</td>
				</tr>
				<tr>
					<td class="light" align="center">Criteria Row</td>
					<td class="light">Each rule can have multiple criteria rows. 
						Each criteria row has four areas.<br>
						<table border="0" width="100%">
							<tr>
								<td class="dark"><i>Area</i> </td>
								<td class="dark">Select the <i>Area</i> in the messages to test.
									See <i>Area</i> below for more information.</td>
							</tr>
							<tr>
								<td class="dark"><i>Compare</i></td>
								<td class="dark">Select the <i>Compare</i> method you want to test with.
									See <i>Compare</i> below for more information.</td>
							</tr>
							<tr>
								<td class="dark"><i>Text</i></td>
								<td class="dark">The text or criteria you want to search for in
									the messages. You may use letters, symbols, or numbers
									in this area. This area isn't case sensitive, an upper case letter
									is treated the same as a lower case letter.<br>
									<b>Example:</b> A large "P" is treated the same as a small "p".</td>
							</tr>
							<tr>
								<td class="dark"><i>Not</i></td>
								<td class="dark">If enabled, this means that the Criteria Area does <u>not</u>
									contain the search text you have defined anywhere.<br><br>
									<b>Example:</b>
									If you put "PopTrayU" in the text area, everything that does <u>not</u>
									have the word "PopTrayU" will cause the rule to match.<br><br>
									<b>Note:</b> Be careful with this option. An easy mistake
									to make is to create a rule that would delete everything
									that doesn't contain your e-mail address in the TO: field,
									but that would mean that any message sent as a CC: or BCC: to you
									will also be deleted.</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="light" align="center">Area</td>
					<td class="light">The area within your e-mail messages that you
						want to test for the text or criteria you have defined.<br>
						<table border="0" width="100%">
							<tr>
								<td class="dark"><i>Header:</i> </td>
								<td class="dark">Anywhere in the header. <b>TIP:</b> Use this
									with caution. Using text such as &quot;from&quot;, &quot;date&quot;
									or other text that may be in all e-mail headers will cause your rule to
									match on all e-mail messages.</td>
							</tr>
							<tr>
								<td class="dark"><i>From:</i></td>
								<td class="dark">The name <u>and</u> e-mail address of the person
									who sent the message. <b>Example:</b> "Joe Smith" &ltjsmith@email.com&gt</td>
							</tr>
							<tr>
								<td class="dark"><i>From (Name):</i></td>
								<td class="dark">Just the name of the person who sent the message.
								<b>Example:</b> "Joe Smith"</td>
							</tr>
							<tr>
								<td class="dark"><i>From (Address):</i></td>
								<td class="dark">Just the e-mail address of the person
									who sent the message. <b>Example:</b> &ltjsmith@email.com&gt</td>
							</tr>
							<tr>
								<td class="dark"><i>Subject:</i></td>
								<td class="dark">The subject line of the message.</td>
							</tr>
							<tr>
								<td class="dark"><i>To:</i></td>
								<td class="dark">The name or e-mail address where the
									message was sent to.</td>
							</tr>
							<tr>
								<td class="dark"><i>CC:</i></td>
								<td class="dark">Additional names or e-mail addresses where the
									message was sent to.</td>
							</tr>
							<tr>
								<td class="dark"><i>Status:</i></td>
								<td class="dark">Checks if an e-mail has the following qualities or attributes.<br><br>
									<table border=0>
										<tr>
											<td><li><i>Protected</i> - Protected by either the white list or a rule.</li></td>
										</tr>
										<tr>
											<td><li><i>To be Deleted</i> - Checks if a message is marked for deletion. **
												Only works along with the "Delete Mail only on Next Check" option on the
												General Options page.</li></td>
										</tr>
										<tr>
											<td><li><i>Ignored</i> - Checks if a message is marked as ignored.</li></td>
										</tr>
										<tr>
											<td><li><i>Spam</i> - Checks if a messages is marked as spam.</li></td>
										</tr>
										<tr>
											<td><li><i>Important</i> - Checks if a message is marked as important. **Important
												isn't the same as an e-mails priority level.</li></td>
										</tr>
										<tr>
											<td><li><i>Has Attachment</i> - Checks if an e-mail has an attachment.</li></td>
										</tr>
										<tr>
											<td><li><i>Viewed</i> - Checks to see if an e-mail has been viewed in the Mail window.</li></td>
										</tr>
										<tr>
											<td><li><i>New</i> - Checks to see if an e-mail is new since the last mail check.</li></td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td class="dark"><i>Body:</i></td>
								<td class="dark">Tests the body of the e-mail message for the search text you have defined.
									** This is only available if you have the "Retrieve Body while Checking" option enabled
									on the Advanced Options page.</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="light" align="center">Compare Method</td>
					<td class="light">
						<table border="0" width="100%">
							<tr>
								<td class="dark"><i>Contains:</i></td>
								<td class="dark">Checks to see if the search text or criteria is contained anywhere in
									the Criteria Area.</td>
							</tr>
							<tr>
								<td class="dark"><i>Equals:</i></td>
								<td class="dark">Checks to see if the Criteria Area is exactly the
									same as your search text or criteria. This is case-insensitive.</td>
							</tr>
							<tr>
								<td class="dark"><i>WildCard:</i></td>
								<td class="dark">Allows you to specify wildcards in
									your search text or criteria. Two wildcard characters are supported:<br><br>
									&nbsp;&nbsp;<b>*</b> &nbsp;&nbsp;Will match any number of characters.<br>
									&nbsp;&nbsp;<b>?</b>&nbsp;&nbsp;Will match only any single character.<br><br>
									<b>Examples:</b><br>
									&nbsp;&nbsp;sp*m will match if the criteria text is
									&quot;spam&quot; or &quot;spaaam&quot;,<br>
									&nbsp;&nbsp;sp?m will match only for &quot;spam&quot;
									or &quot;sp@m&quot;, not &quot;spaam&quot;.<br><br>
									Without using any wildcards, the text is compared the
									same as if you had used <i>&quot;Equals&quot;</i>.<br><br>
									If you use *text*, it will
									compare the same as if you had used <i>&quot;Contains&quot;</i>.<br><br>
									If you use &quot;a*&quot;, it will match all words where the
									text start with an &quot;a&quot;.</td>
							</tr>
							<tr>
								<td class="dark"><i>Empty:</i></td>
								<td class="dark">Matchs if the Criteria Area contains no characters at all.
									<b>Note:</b> Spaces are considered characters so if an area has spaces
									it won't be considered empty.</td>
							</tr>
							<tr>
								<td class="dark"><i>RegExpr:</i></td>
								<td class="dark">Using regular expressions allows your searchs to be very
									precise or very flexible. You could say that its is like <i>Wildcards</i>
									on steriods. To learn more about regular expressions, do a search on the internet for "regular expressions"<br>
									<br>
									To test if your regular expression syntax you have made is valid, just press the
								<img src="img/testregexpr.png" height=19 width=19> button next to it.</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="light" align="center">Actions</td>
					<td class="light">PopTrayU can perform the following actions when an e-mail message
						arrives that matchs the criteria that you have defined.<br>
						<table border="0" width="100%">
							<tr>
								<td class="dark" width="115"><i>Delete from Server:</i></td>
								<td class="dark">Delete the message from the server
								without showing it to you or notifying you of it's
								arrival. <b>Use With Caution</b>.</td>
							</tr>
							<tr>
								<td class="dark"><i>Play Sound:</i> </td>
								<td class="dark">Will allow you to play a different sound than
								the account or default sound.</td>
							</tr>
							<tr>
								<td class="dark"><i>Mark as Spam:</i></td>
								<td class="dark">
									Mark the message as Spam.  It will be shown with a
									different icon <img src="img/mail_spam.gif" height=16 width=16> and you can delete all spam messages
									by click the <i>"Del Spam"</i> button in the Mail Window.</td>
							</tr>
							<tr>
								<td class="dark"><i>Execute file:</i></td>
								<td class="dark">
									Run the selected program or open the selected file.<br><br>
									You can specify macros in the command you want to execute,
									and these will be replaced by the corresponding value.
									<ul>The following macros are supported:
										<li>%ACCOUNT%
										<li>%ACCOUNTNUM%
										<li>%FROM%
										<li>%FROMADDRESS%
										<li>%TO%
										<li>%SUBJECT%
										<li>%DATE%
										<li>%SIZE%
										<li>%MSGID%
										<li>%UID%
										<li>%MSGNUM%</li>
									</ul>
									<b>Note:</b> While you can use this by simply selecting the 
									program to run or file to open, it can be very powerful also. 
									This can extend PopTrays functionality to utilize every program's 
									capability if it is available from the other program's command-line options.</td>
							</tr>
							<tr>
								<td class="dark"><i>Ignore:</i></td>
								<td class="dark">PopTrayU won't notify you when the message
								arrives. No notification sound will be played, and
								it won't be indicated on the tray icon. It will also show
								a different icon <img src="img/mail_ignore.gif" height=16 width=16> in the Mail Window.</td>
							</tr>
							<tr>
								<td class="dark"><i>Tray Color:</i></td>
								<td class="dark">You can change the tray notification color to one 
									that is different than the color selected for the account.</td>
							</tr>
							<tr>
								<td class="dark"><i>Important:</i></td>
								<td class="dark">The message will be marked as important
									and a different icon <img src="img/mail_important.gif" height=16 width=16>will be displayed. Also a balloon
									pop-up (on Win2000 and later) will be displayed that an
									important message has arrived.</td>
							</tr>
							<tr>
								<td class="dark"><i>Protect against<br> auto-delete:</i></td>
								<td class="dark">Protect the message against rules and the blacklist that
									would otherwise delete the message.  Also protect against
									being marked a spam. The message will get a green icon
									<img src="img/mail_protect.gif" height=16 width=16>
									to show it is protected.</td>
							</tr>
							<tr>
								<td class="dark"><i>Log Rule:</i></td>
								<td class="dark">
									When <i>"Log Rules"</i> is enabled, this rule
									will get written to the log when a rule has a match. ** Requires that the option
									<i>Log Rules</i> also be enabled in the Miscellaneous Options page.<br><br>
									The log is named <i>Rules.log</i> and can be found in the PopTrayU or User
									defined directory.</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
			<br>
			After filling in the details above, remember to click the <i>&quot;Save
			Rules&quot;</i> button. This will save all the rules to Rules.ini file in the PopTrayU or
			User defined directory.</td>
	</tr>
</table>

<script language="JavaScript" src="footer.js"></script>

</body>
</html>
